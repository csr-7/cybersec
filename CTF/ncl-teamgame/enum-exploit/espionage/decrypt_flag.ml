let hide str =
  try
    let value = int_of_string ("0o" ^ str) in
    if value >= 0 && value <= 255 then
      Some (Char.chr value)
    else
      None
  with
  | Failure _ | Invalid_argument _ | Sys.Break | End_of_file -> None ;;

let decrypt str =
  let dirtyWork c = Char.chr (Char.code c lxor 0x17) in
  let converted_str = List.map (fun c -> dirtyWork c) str in
  String.concat "" (List.map (String.make 1) converted_str)

let main () =
  let check = ["104"; "134"; "116"; "72"; "124"; "126"; "132"; "133"; "72"; "46"; "44"; "47"; "57"] in
  let decrypted_check = List.map (fun s -> match hide s with Some ch -> ch | None -> ' ') check in
  let decrypted_flag = decrypt decrypted_check in
  Printf.printf "The flag is: %s\n" decrypted_flag
;;

main ();;

